"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.ReactInspectorPlugin = void 0;
const errorOverlayMiddleware_1 = __importDefault(require("react-dev-utils/errorOverlayMiddleware"));
/**
 * [webpack service side]
 *
 * add launch editor middleware in webpack devServer.before method
 *
 * https://webpack.js.org/configuration/dev-server/#devserverbefore
 * https://webpack.js.org/contribute/writing-a-plugin
 */
class ReactInspectorPlugin {
    apply(compiler) {
        if (!compiler.options.devServer) {
            compiler.options.devServer = {
                before: (app) => {
                    app.use(errorOverlayMiddleware_1.default());
                },
            };
            return;
        }
        const originBefore = compiler.options.devServer.before;
        compiler.options.devServer.before = (app, server, compiler) => {
            app.use(errorOverlayMiddleware_1.default());
            originBefore === null || originBefore === void 0 ? void 0 : originBefore(app, server, compiler);
        };
    }
}
exports.ReactInspectorPlugin = ReactInspectorPlugin;
