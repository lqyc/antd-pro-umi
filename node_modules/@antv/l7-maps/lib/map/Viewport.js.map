{"version":3,"sources":["../../src/map/Viewport.ts"],"names":["Viewport","viewport","mapCamera","center","zoom","pitch","bearing","viewportHeight","viewportWidth","WebMercatorViewport","width","height","longitude","latitude","Math","pow","getZoom","projectionMatrix","viewMatrix","viewMatrixUncentered","viewProjectionMatrix","lngLat","scale","projectFlat"],"mappings":";;;;;;;;;;;;;AACA;;IAEqBA,Q;;;SACXC,Q;;;;;WAER,2BAAyBC,SAAzB,EAAyD;AAAA,UAErDC,MAFqD,GAQnDD,SARmD,CAErDC,MAFqD;AAAA,UAGrDC,IAHqD,GAQnDF,SARmD,CAGrDE,IAHqD;AAAA,UAIrDC,KAJqD,GAQnDH,SARmD,CAIrDG,KAJqD;AAAA,UAKrDC,OALqD,GAQnDJ,SARmD,CAKrDI,OALqD;AAAA,UAMrDC,cANqD,GAQnDL,SARmD,CAMrDK,cANqD;AAAA,UAOrDC,aAPqD,GAQnDN,SARmD,CAOrDM,aAPqD;AAcvD,WAAKP,QAAL,GAAgB,IAAIQ,gCAAJ,CAAwB;AACtCC,QAAAA,KAAK,EAAEF,aAD+B;AAEtCG,QAAAA,MAAM,EAAEJ,cAF8B;AAGtCK,QAAAA,SAAS,EAAET,MAAM,IAAIA,MAAM,CAAC,CAAD,CAHW;AAItCU,QAAAA,QAAQ,EAAEV,MAAM,IAAIA,MAAM,CAAC,CAAD,CAJY;AAKtCC,QAAAA,IAAI,EAAJA,IALsC;AAMtCC,QAAAA,KAAK,EAALA,KANsC;AAOtCC,QAAAA,OAAO,EAAPA;AAPsC,OAAxB,CAAhB;AASD;;;WAED,mBAAyB;AACvB,aAAO,KAAKL,QAAL,CAAcG,IAArB;AACD;;;WAED,wBAA8B;AAC5B,aAAOU,IAAI,CAACC,GAAL,CAAS,CAAT,EAAY,KAAKC,OAAL,EAAZ,CAAP;AACD;;;WAED,qBAAqC;AACnC,aAAO,CAAC,KAAKf,QAAL,CAAcW,SAAf,EAA0B,KAAKX,QAAL,CAAcY,QAAxC,CAAP;AACD;;;WAED,+BAAuC;AACrC,aAAO,KAAKZ,QAAL,CAAcgB,gBAArB;AACD;;;WAED,yBAAiC;AAC/B,aAAO,KAAKhB,QAAL,CAAciB,UAArB;AACD;;;WAED,mCAA2C;AAEzC,aAAO,KAAKjB,QAAL,CAAckB,oBAArB;AACD;;;WACD,mCAA2C;AAEzC,aAAO,KAAKlB,QAAL,CAAcmB,oBAArB;AACD;;;WAED,6CAAqD;AAEnD,aAAO,KAAKnB,QAAL,CAAcmB,oBAArB;AACD;;;WACD,4BAA0B;AACxB,aAAO,CAAP;AACD;;;WAED,qBACEC,MADF,EAEEC,KAFF,EAGoB;AAClB,aAAO,KAAKrB,QAAL,CAAcsB,WAAd,CAA0BF,MAA1B,EAAkCC,KAAlC,CAAP;AACD","sourcesContent":["import { IMapCamera, IViewport } from '@antv/l7-core';\nimport WebMercatorViewport from 'viewport-mercator-project';\n\nexport default class Viewport implements IViewport {\n  private viewport: WebMercatorViewport;\n\n  public syncWithMapCamera(mapCamera: Partial<IMapCamera>) {\n    const {\n      center,\n      zoom,\n      pitch,\n      bearing,\n      viewportHeight,\n      viewportWidth,\n    } = mapCamera;\n\n    /**\n     * Deck.gl 使用的也是 Mapbox 同步相机，相机参数保持一致\n     * 例如相机高度固定为 height * 1.5，因此不需要传\n     */\n    this.viewport = new WebMercatorViewport({\n      width: viewportWidth,\n      height: viewportHeight,\n      longitude: center && center[0],\n      latitude: center && center[1],\n      zoom,\n      pitch,\n      bearing,\n    });\n  }\n\n  public getZoom(): number {\n    return this.viewport.zoom;\n  }\n\n  public getZoomScale(): number {\n    return Math.pow(2, this.getZoom());\n  }\n\n  public getCenter(): [number, number] {\n    return [this.viewport.longitude, this.viewport.latitude];\n  }\n\n  public getProjectionMatrix(): number[] {\n    return this.viewport.projectionMatrix;\n  }\n\n  public getViewMatrix(): number[] {\n    return this.viewport.viewMatrix;\n  }\n\n  public getViewMatrixUncentered(): number[] {\n    // @ts-ignore\n    return this.viewport.viewMatrixUncentered;\n  }\n  public getViewProjectionMatrix(): number[] {\n    // @ts-ignore\n    return this.viewport.viewProjectionMatrix;\n  }\n\n  public getViewProjectionMatrixUncentered(): number[] {\n    // @ts-ignore\n    return this.viewport.viewProjectionMatrix;\n  }\n  public getFocalDistance() {\n    return 1;\n  }\n\n  public projectFlat(\n    lngLat: [number, number],\n    scale?: number | undefined,\n  ): [number, number] {\n    return this.viewport.projectFlat(lngLat, scale);\n  }\n}\n"],"file":"Viewport.js"}