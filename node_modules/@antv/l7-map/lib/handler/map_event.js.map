{"version":3,"sources":["../../src/handler/map_event.ts"],"names":["MapEventHandler","map","options","mousedownPos","clickTolerance","e","firePreventable","MapWheelEvent","type","point","MapMouseEvent","emit","dist","MapTouchEvent","mapEvent","defaultPrevented"],"mappings":"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","sourcesContent":["// @ts-ignore\nimport Point from '../geo/point';\nimport { Map } from '../map';\nimport { MapMouseEvent, MapTouchEvent, MapWheelEvent } from './events';\n\nexport default class MapEventHandler {\n  private mousedownPos: Point;\n  private clickTolerance: number;\n  private map: Map;\n\n  constructor(map: Map, options: { clickTolerance: number }) {\n    this.map = map;\n    this.clickTolerance = options.clickTolerance;\n  }\n\n  public reset() {\n    delete this.mousedownPos;\n  }\n\n  public wheel(e: WheelEvent) {\n    // If mapEvent.preventDefault() is called by the user, prevent handlers such as:\n    // - ScrollZoom\n    return this.firePreventable(new MapWheelEvent(e.type, this.map, e));\n  }\n\n  public mousedown(e: MouseEvent, point: Point) {\n    this.mousedownPos = point;\n    // If mapEvent.preventDefault() is called by the user, prevent handlers such as:\n    // - MousePan\n    // - MouseRotate\n    // - MousePitch\n    // - DblclickHandler\n    return this.firePreventable(new MapMouseEvent(e.type, this.map, e));\n  }\n\n  public mouseup(e: MouseEvent) {\n    this.map.emit(e.type, new MapMouseEvent(e.type, this.map, e));\n  }\n\n  public click(e: MouseEvent, point: Point) {\n    if (\n      this.mousedownPos &&\n      this.mousedownPos.dist(point) >= this.clickTolerance\n    ) {\n      return;\n    }\n    this.map.emit(e.type, new MapMouseEvent(e.type, this.map, e));\n  }\n\n  public dblclick(e: MouseEvent) {\n    // If mapEvent.preventDefault() is called by the user, prevent handlers such as:\n    // - DblClickZoom\n    return this.firePreventable(new MapMouseEvent(e.type, this.map, e));\n  }\n\n  public mouseover(e: MouseEvent) {\n    this.map.emit(e.type, new MapMouseEvent(e.type, this.map, e));\n  }\n\n  public mouseout(e: MouseEvent) {\n    this.map.emit(e.type, new MapMouseEvent(e.type, this.map, e));\n  }\n\n  public touchstart(e: TouchEvent) {\n    // If mapEvent.preventDefault() is called by the user, prevent handlers such as:\n    // - TouchPan\n    // - TouchZoom\n    // - TouchRotate\n    // - TouchPitch\n    // - TapZoom\n    // - SwipeZoom\n    return this.firePreventable(new MapTouchEvent(e.type, this.map, e));\n  }\n\n  public touchmove(e: TouchEvent) {\n    this.map.emit(e.type, new MapTouchEvent(e.type, this.map, e));\n  }\n\n  public touchend(e: TouchEvent) {\n    this.map.emit(e.type, new MapTouchEvent(e.type, this.map, e));\n  }\n\n  public touchcancel(e: TouchEvent) {\n    this.map.emit(e.type, new MapTouchEvent(e.type, this.map, e));\n  }\n\n  public firePreventable(\n    mapEvent: MapMouseEvent | MapTouchEvent | MapWheelEvent,\n  ) {\n    this.map.emit(mapEvent.type, mapEvent);\n    if (mapEvent.defaultPrevented) {\n      // returning an object marks the handler as active and resets other handlers\n      return {};\n    }\n  }\n\n  public isEnabled() {\n    return true;\n  }\n\n  public isActive() {\n    return false;\n  }\n  public enable() {\n    return false;\n  }\n  public disable() {\n    return false;\n  }\n}\n"],"file":"map_event.js"}