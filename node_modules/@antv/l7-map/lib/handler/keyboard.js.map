{"version":3,"sources":["../../src/handler/keyboard.ts"],"names":["defaultOptions","panStep","bearingStep","pitchStep","KeyboardHandler","enabled","active","stepOptions","e","altKey","ctrlKey","metaKey","zoomDir","bearingDir","pitchDir","xDir","yDir","keyCode","shiftKey","preventDefault","cameraAnimation","map","zoom","getZoom","easeTo","duration","easeId","easing","easeOut","Math","round","bearing","getBearing","pitch","getPitch","offset","center","getCenter","originalEvent","reset","t"],"mappings":";;;;;;;;;;;;;AAEA,IAAMA,cAAc,GAAG;AACrBC,EAAAA,OAAO,EAAE,GADY;AAErBC,EAAAA,WAAW,EAAE,EAFQ;AAGrBC,EAAAA,SAAS,EAAE;AAHU,CAAvB;;IAoBMC,e;AAUJ,6BAAc;AAAA;AAAA,SATNC,OASM;AAAA,SARNC,MAQM;AAAA,SAPNL,OAOM;AAAA,SANNC,WAMM;AAAA,SALNC,SAKM;AACZ,QAAMI,WAAW,GAAGP,cAApB;AACA,SAAKC,OAAL,GAAeM,WAAW,CAACN,OAA3B;AACA,SAAKC,WAAL,GAAmBK,WAAW,CAACL,WAA/B;AACA,SAAKC,SAAL,GAAiBI,WAAW,CAACJ,SAA7B;AACD;;;;WAED,iBAAe;AACb,WAAKG,MAAL,GAAc,KAAd;AACD;;;WAED,iBAAeE,CAAf,EAAiC;AAAA;;AAC/B,UAAIA,CAAC,CAACC,MAAF,IAAYD,CAAC,CAACE,OAAd,IAAyBF,CAAC,CAACG,OAA/B,EAAwC;AACtC;AACD;;AACD,UAAIC,OAAO,GAAG,CAAd;AACA,UAAIC,UAAU,GAAG,CAAjB;AACA,UAAIC,QAAQ,GAAG,CAAf;AACA,UAAIC,IAAI,GAAG,CAAX;AACA,UAAIC,IAAI,GAAG,CAAX;;AAEA,cAAQR,CAAC,CAACS,OAAV;AACE,aAAK,EAAL;AACA,aAAK,GAAL;AACA,aAAK,GAAL;AACA,aAAK,GAAL;AACEL,UAAAA,OAAO,GAAG,CAAV;AACA;;AAEF,aAAK,GAAL;AACA,aAAK,GAAL;AACA,aAAK,GAAL;AACEA,UAAAA,OAAO,GAAG,CAAC,CAAX;AACA;;AAEF,aAAK,EAAL;AACE,cAAIJ,CAAC,CAACU,QAAN,EAAgB;AACdL,YAAAA,UAAU,GAAG,CAAC,CAAd;AACD,WAFD,MAEO;AACLL,YAAAA,CAAC,CAACW,cAAF;AACAJ,YAAAA,IAAI,GAAG,CAAC,CAAR;AACD;;AACD;;AAEF,aAAK,EAAL;AACE,cAAIP,CAAC,CAACU,QAAN,EAAgB;AACdL,YAAAA,UAAU,GAAG,CAAb;AACD,WAFD,MAEO;AACLL,YAAAA,CAAC,CAACW,cAAF;AACAJ,YAAAA,IAAI,GAAG,CAAP;AACD;;AACD;;AAEF,aAAK,EAAL;AACE,cAAIP,CAAC,CAACU,QAAN,EAAgB;AACdJ,YAAAA,QAAQ,GAAG,CAAX;AACD,WAFD,MAEO;AACLN,YAAAA,CAAC,CAACW,cAAF;AACAH,YAAAA,IAAI,GAAG,CAAC,CAAR;AACD;;AACD;;AAEF,aAAK,EAAL;AACE,cAAIR,CAAC,CAACU,QAAN,EAAgB;AACdJ,YAAAA,QAAQ,GAAG,CAAC,CAAZ;AACD,WAFD,MAEO;AACLN,YAAAA,CAAC,CAACW,cAAF;AACAH,YAAAA,IAAI,GAAG,CAAP;AACD;;AACD;;AAEF;AACE;AAnDJ;;AAsDA,aAAO;AACLI,QAAAA,eAAe,EAAE,yBAACC,GAAD,EAAc;AAC7B,cAAMC,IAAI,GAAGD,GAAG,CAACE,OAAJ,EAAb;AACAF,UAAAA,GAAG,CAACG,MAAJ,CACE;AACEC,YAAAA,QAAQ,EAAE,GADZ;AAEEC,YAAAA,MAAM,EAAE,iBAFV;AAGEC,YAAAA,MAAM,EAAEC,OAHV;AAKEN,YAAAA,IAAI,EAAEV,OAAO,GACTiB,IAAI,CAACC,KAAL,CAAWR,IAAX,IAAmBV,OAAO,IAAIJ,CAAC,CAACU,QAAF,GAAa,CAAb,GAAiB,CAArB,CADjB,GAETI,IAPN;AAQES,YAAAA,OAAO,EAAEV,GAAG,CAACW,UAAJ,KAAmBnB,UAAU,GAAG,KAAI,CAACX,WARhD;AASE+B,YAAAA,KAAK,EAAEZ,GAAG,CAACa,QAAJ,KAAiBpB,QAAQ,GAAG,KAAI,CAACX,SAT1C;AAUEgC,YAAAA,MAAM,EAAE,CAAC,CAACpB,IAAD,GAAQ,KAAI,CAACd,OAAd,EAAuB,CAACe,IAAD,GAAQ,KAAI,CAACf,OAApC,CAVV;AAWEmC,YAAAA,MAAM,EAAEf,GAAG,CAACgB,SAAJ;AAXV,WADF,EAcE;AAAEC,YAAAA,aAAa,EAAE9B;AAAjB,WAdF;AAgBD;AAnBI,OAAP;AAqBD;;;WAED,kBAAgB;AACd,WAAKH,OAAL,GAAe,IAAf;AACD;;;WAED,mBAAiB;AACf,WAAKA,OAAL,GAAe,KAAf;AACA,WAAKkC,KAAL;AACD;;;WAED,qBAAmB;AACjB,aAAO,KAAKlC,OAAZ;AACD;;;WAED,oBAAkB;AAChB,aAAO,KAAKC,MAAZ;AACD;;;;;AAGH,SAASsB,OAAT,CAAiBY,CAAjB,EAA4B;AAC1B,SAAOA,CAAC,IAAI,IAAIA,CAAR,CAAR;AACD;;eAEcpC,e","sourcesContent":["import { Map } from '../map';\n\nconst defaultOptions = {\n  panStep: 100,\n  bearingStep: 15,\n  pitchStep: 10,\n};\n\n/**\n * The `KeyboardHandler` allows the user to zoom, rotate, and pan the map using\n * the following keyboard shortcuts:\n *\n * - `=` / `+`: Increase the zoom level by 1.\n * - `Shift-=` / `Shift-+`: Increase the zoom level by 2.\n * - `-`: Decrease the zoom level by 1.\n * - `Shift--`: Decrease the zoom level by 2.\n * - Arrow keys: Pan by 100 pixels.\n * - `Shift+⇢`: Increase the rotation by 15 degrees.\n * - `Shift+⇠`: Decrease the rotation by 15 degrees.\n * - `Shift+⇡`: Increase the pitch by 10 degrees.\n * - `Shift+⇣`: Decrease the pitch by 10 degrees.\n */\nclass KeyboardHandler {\n  private enabled: boolean;\n  private active: boolean;\n  private panStep: number;\n  private bearingStep: number;\n  private pitchStep: number;\n\n  /**\n   * @private\n   */\n  constructor() {\n    const stepOptions = defaultOptions;\n    this.panStep = stepOptions.panStep;\n    this.bearingStep = stepOptions.bearingStep;\n    this.pitchStep = stepOptions.pitchStep;\n  }\n\n  public reset() {\n    this.active = false;\n  }\n\n  public keydown(e: KeyboardEvent) {\n    if (e.altKey || e.ctrlKey || e.metaKey) {\n      return;\n    }\n    let zoomDir = 0;\n    let bearingDir = 0;\n    let pitchDir = 0;\n    let xDir = 0;\n    let yDir = 0;\n\n    switch (e.keyCode) {\n      case 61:\n      case 107:\n      case 171:\n      case 187:\n        zoomDir = 1;\n        break;\n\n      case 189:\n      case 109:\n      case 173:\n        zoomDir = -1;\n        break;\n\n      case 37:\n        if (e.shiftKey) {\n          bearingDir = -1;\n        } else {\n          e.preventDefault();\n          xDir = -1;\n        }\n        break;\n\n      case 39:\n        if (e.shiftKey) {\n          bearingDir = 1;\n        } else {\n          e.preventDefault();\n          xDir = 1;\n        }\n        break;\n\n      case 38:\n        if (e.shiftKey) {\n          pitchDir = 1;\n        } else {\n          e.preventDefault();\n          yDir = -1;\n        }\n        break;\n\n      case 40:\n        if (e.shiftKey) {\n          pitchDir = -1;\n        } else {\n          e.preventDefault();\n          yDir = 1;\n        }\n        break;\n\n      default:\n        return;\n    }\n\n    return {\n      cameraAnimation: (map: Map) => {\n        const zoom = map.getZoom();\n        map.easeTo(\n          {\n            duration: 300,\n            easeId: 'keyboardHandler',\n            easing: easeOut,\n\n            zoom: zoomDir\n              ? Math.round(zoom) + zoomDir * (e.shiftKey ? 2 : 1)\n              : zoom,\n            bearing: map.getBearing() + bearingDir * this.bearingStep,\n            pitch: map.getPitch() + pitchDir * this.pitchStep,\n            offset: [-xDir * this.panStep, -yDir * this.panStep],\n            center: map.getCenter(),\n          },\n          { originalEvent: e },\n        );\n      },\n    };\n  }\n\n  public enable() {\n    this.enabled = true;\n  }\n\n  public disable() {\n    this.enabled = false;\n    this.reset();\n  }\n\n  public isEnabled() {\n    return this.enabled;\n  }\n\n  public isActive() {\n    return this.active;\n  }\n}\n\nfunction easeOut(t: number) {\n  return t * (2 - t);\n}\n\nexport default KeyboardHandler;\n"],"file":"keyboard.js"}