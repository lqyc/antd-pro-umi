{"version":3,"sources":["../../../src/handler/tap/tap_recognizer.ts"],"names":["TapRecognizer","options","singleTap","numTaps","lastTime","lastTap","count","SingleTapRecognizer","reset","Infinity","e","points","mapTouches","touchstart","touchmove","tap","touchend","soonEnough","timeStamp","MAX_TAP_INTERVAL","closeEnough","dist","MAX_DIST"],"mappings":";;;;;;;;;;;;;;;AAEA;;IAKqBA,a;AAOnB,yBAAYC,OAAZ,EAA8D;AAAA;AAAA,SANvDC,SAMuD;AAAA,SALvDC,OAKuD;AAAA,SAJvDC,QAIuD;AAAA,SAHvDC,OAGuD;AAAA,SAFvDC,KAEuD;AAC5D,SAAKJ,SAAL,GAAiB,IAAIK,8BAAJ,CAAwBN,OAAxB,CAAjB;AACA,SAAKE,OAAL,GAAeF,OAAO,CAACE,OAAvB;AACA,SAAKK,KAAL;AACD;;;;WAED,iBAAe;AACb,WAAKJ,QAAL,GAAgBK,QAAhB;AACA,aAAO,KAAKJ,OAAZ;AACA,WAAKC,KAAL,GAAa,CAAb;AACA,WAAKJ,SAAL,CAAeM,KAAf;AACD;;;WAED,oBAAkBE,CAAlB,EAAiCC,MAAjC,EAAkDC,UAAlD,EAAuE;AACrE,WAAKV,SAAL,CAAeW,UAAf,CAA0BH,CAA1B,EAA6BC,MAA7B,EAAqCC,UAArC;AACD;;;WAED,mBAAiBF,CAAjB,EAAgCC,MAAhC,EAAiDC,UAAjD,EAAsE;AACpE,WAAKV,SAAL,CAAeY,SAAf,CAAyBJ,CAAzB,EAA4BC,MAA5B,EAAoCC,UAApC;AACD;;;WAED,kBAAgBF,CAAhB,EAA+BC,MAA/B,EAAgDC,UAAhD,EAAqE;AACnE,UAAMG,GAAG,GAAG,KAAKb,SAAL,CAAec,QAAf,CAAwBN,CAAxB,EAA2BC,MAA3B,EAAmCC,UAAnC,CAAZ;;AACA,UAAIG,GAAJ,EAAS;AACP,YAAME,UAAU,GAAGP,CAAC,CAACQ,SAAF,GAAc,KAAKd,QAAnB,GAA8Be,uCAAjD;;AACA,YAAMC,WAAW,GAAG,CAAC,KAAKf,OAAN,IAAiB,KAAKA,OAAL,CAAagB,IAAb,CAAkBN,GAAlB,IAAyBO,+BAA9D;;AAEA,YAAI,CAACL,UAAD,IAAe,CAACG,WAApB,EAAiC;AAC/B,eAAKZ,KAAL;AACD;;AAED,aAAKF,KAAL;AACA,aAAKF,QAAL,GAAgBM,CAAC,CAACQ,SAAlB;AACA,aAAKb,OAAL,GAAeU,GAAf;;AAEA,YAAI,KAAKT,KAAL,KAAe,KAAKH,OAAxB,EAAiC;AAC/B,eAAKK,KAAL;AACA,iBAAOO,GAAP;AACD;AACF;AACF","sourcesContent":["// @ts-ignore\nimport Point from '../../geo/point';\nimport SingleTapRecognizer, {\n  MAX_DIST,\n  MAX_TAP_INTERVAL,\n} from './single_tap_recognizer';\n\nexport default class TapRecognizer {\n  public singleTap: SingleTapRecognizer;\n  public numTaps: number;\n  public lastTime: number;\n  public lastTap: Point;\n  public count: number;\n\n  constructor(options: { numTaps: number; numTouches: number }) {\n    this.singleTap = new SingleTapRecognizer(options);\n    this.numTaps = options.numTaps;\n    this.reset();\n  }\n\n  public reset() {\n    this.lastTime = Infinity;\n    delete this.lastTap;\n    this.count = 0;\n    this.singleTap.reset();\n  }\n\n  public touchstart(e: TouchEvent, points: Point[], mapTouches: Touch[]) {\n    this.singleTap.touchstart(e, points, mapTouches);\n  }\n\n  public touchmove(e: TouchEvent, points: Point[], mapTouches: Touch[]) {\n    this.singleTap.touchmove(e, points, mapTouches);\n  }\n\n  public touchend(e: TouchEvent, points: Point[], mapTouches: Touch[]) {\n    const tap = this.singleTap.touchend(e, points, mapTouches);\n    if (tap) {\n      const soonEnough = e.timeStamp - this.lastTime < MAX_TAP_INTERVAL;\n      const closeEnough = !this.lastTap || this.lastTap.dist(tap) < MAX_DIST;\n\n      if (!soonEnough || !closeEnough) {\n        this.reset();\n      }\n\n      this.count++;\n      this.lastTime = e.timeStamp;\n      this.lastTap = tap;\n\n      if (this.count === this.numTaps) {\n        this.reset();\n        return tap;\n      }\n    }\n  }\n}\n"],"file":"tap_recognizer.js"}