{"version":3,"sources":["../../src/parser/json.ts"],"names":["json","data","cfg","x","y","x1","y1","coordinates","resultData","forEach","col","featureIndex","coords","parseFloat","from","to","type","Array","isArray","geometry","dataItem","_id","push","dataArray"],"mappings":";;;;;;;;;;;;;AASA;;;;;;AACe,SAASA,IAAT,CAAcC,IAAd,EAA+BC,GAA/B,EAA6D;AAAA,MAClEC,CADkE,GACpCD,GADoC,CAClEC,CADkE;AAAA,MAC/DC,CAD+D,GACpCF,GADoC,CAC/DE,CAD+D;AAAA,MAC5DC,EAD4D,GACpCH,GADoC,CAC5DG,EAD4D;AAAA,MACxDC,EADwD,GACpCJ,GADoC,CACxDI,EADwD;AAAA,MACpDC,WADoD,GACpCL,GADoC,CACpDK,WADoD;AAE1E,MAAMC,UAA4B,GAAG,EAArC;AACAP,EAAAA,IAAI,CAACQ,OAAL,CAAa,UAACC,GAAD,EAAiBC,YAAjB,EAA0C;AACrD,QAAIC,MAAM,GAAG,EAAb;;AACA,QAAIT,CAAC,IAAIC,CAAT,EAAY;AACVQ,MAAAA,MAAM,GAAG,CAACC,UAAU,CAACH,GAAG,CAACP,CAAD,CAAJ,CAAX,EAAqBU,UAAU,CAACH,GAAG,CAACN,CAAD,CAAJ,CAA/B,CAAT;AACD;;AACD,QAAID,CAAC,IAAIC,CAAL,IAAUC,EAAV,IAAgBC,EAApB,EAAwB;AACtB,UAAMQ,IAAI,GAAG,CAACD,UAAU,CAACH,GAAG,CAACP,CAAD,CAAJ,CAAX,EAAqBU,UAAU,CAACH,GAAG,CAACN,CAAD,CAAJ,CAA/B,CAAb;AACA,UAAMW,EAAE,GAAG,CAACF,UAAU,CAACH,GAAG,CAACL,EAAD,CAAJ,CAAX,EAAsBQ,UAAU,CAACH,GAAG,CAACJ,EAAD,CAAJ,CAAhC,CAAX;AACAM,MAAAA,MAAM,GAAG,CAACE,IAAD,EAAOC,EAAP,CAAT;AACD;;AACD,QAAIR,WAAJ,EAAiB;AACf,UAAIS,IAAI,GAAG,SAAX;;AACA,UAAI,CAACC,KAAK,CAACC,OAAN,CAAcX,WAAW,CAAC,CAAD,CAAzB,CAAL,EAAoC;AAClCS,QAAAA,IAAI,GAAG,OAAP;AACD;;AACD,UAAIC,KAAK,CAACC,OAAN,CAAcX,WAAW,CAAC,CAAD,CAAzB,KAAiC,CAACU,KAAK,CAACC,OAAN,CAAcX,WAAW,CAAC,CAAD,CAAX,CAAe,CAAf,CAAd,CAAtC,EAAwE;AACtES,QAAAA,IAAI,GAAG,YAAP;AACD;;AACD,UAAMG,QAAQ,GAAG;AACfH,QAAAA,IAAI,EAAJA,IADe;AAEfT,QAAAA,WAAW,mCAAMG,GAAG,CAACH,WAAD,CAAT;AAFI,OAAjB;AAIA,kCAAOY,QAAP,EAAiB,IAAjB;AACAP,MAAAA,MAAM,GAAGO,QAAQ,CAACZ,WAAlB;AACD;;AACD,QAAMa,QAAQ,mCACTV,GADS;AAEZW,MAAAA,GAAG,EAAEV,YAFO;AAGZJ,MAAAA,WAAW,EAAEK;AAHD,MAAd;;AAKAJ,IAAAA,UAAU,CAACc,IAAX,CAAgBF,QAAhB;AACD,GA/BD;AAgCA,SAAO;AACLG,IAAAA,SAAS,EAAEf;AADN,GAAP;AAGD","sourcesContent":["// @ts-ignore\nimport {\n  IJsonData,\n  IJsonItem,\n  IParseDataItem,\n  IParserCfg,\n  IParserData,\n} from '@antv/l7-core';\n// @ts-ignore\nimport rewind from '@mapbox/geojson-rewind';\nexport default function json(data: IJsonData, cfg: IParserCfg): IParserData {\n  const { x, y, x1, y1, coordinates } = cfg;\n  const resultData: IParseDataItem[] = [];\n  data.forEach((col: IJsonItem, featureIndex: number) => {\n    let coords = [];\n    if (x && y) {\n      coords = [parseFloat(col[x]), parseFloat(col[y])];\n    } // 点数据\n    if (x && y && x1 && y1) {\n      const from = [parseFloat(col[x]), parseFloat(col[y])];\n      const to = [parseFloat(col[x1]), parseFloat(col[y1])];\n      coords = [from, to];\n    }\n    if (coordinates) {\n      let type = 'Polygon';\n      if (!Array.isArray(coordinates[0])) {\n        type = 'Point';\n      }\n      if (Array.isArray(coordinates[0]) && !Array.isArray(coordinates[0][0])) {\n        type = 'LineString';\n      }\n      const geometry = {\n        type,\n        coordinates: [...col[coordinates]],\n      };\n      rewind(geometry, true);\n      coords = geometry.coordinates;\n    }\n    const dataItem = {\n      ...col,\n      _id: featureIndex,\n      coordinates: coords,\n    };\n    resultData.push(dataItem);\n  });\n  return {\n    dataArray: resultData,\n  };\n}\n"],"file":"json.js"}