"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _default = "\nimport React, { useRef, useEffect } from \"react\";\nimport { plugin } from \"../core/umiExports\";\nimport { ApplyPluginsType } from 'umi';\nimport { useModel } from \"../plugin-model/useModel\";\nif (typeof useModel !== \"function\") {\n  throw new Error(\n    \"[plugin-initial-state]: useModel is not a function, @umijs/plugin-model is required.\"\n  );\n}\n\ninterface Props {\n  children: React.ReactNode;\n}\nexport default (props: Props) => {\n  const { children } = props;\n  const appLoaded = useRef(false);\n  // \u83B7\u53D6\u7528\u6237\u7684\u914D\u7F6E\uFF0C\u6682\u65F6\u53EA\u652F\u6301 loading\n  const useRuntimeConfig =\n    plugin.applyPlugins({\n      key: \"initialStateConfig\",\n      type: ApplyPluginsType.modify,\n      initialValue: {},\n    }) || {};\n  const { loading = false } = useModel(\"@@initialState\") || {};\n  useEffect(() => {\n    if (!loading) {\n      appLoaded.current = true;\n    }\n  }, [loading]);\n  // initial state loading \u65F6\uFF0C\u963B\u585E\u6E32\u67D3\n  if (loading && !appLoaded.current) {\n    return useRuntimeConfig.loading || null;\n  }\n  return children;\n};\n";
exports.default = _default;